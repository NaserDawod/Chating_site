<!DOCTYPE html>
<html leng = "en">
    <head>
        <meta charset="UTF-8">
        <title>Voice message send</title>
        <style type="text/css">
            .audio{
                width: 400px;
                height: 600px;
                border-radius: 20px;
                padding: 20px;
                border: 20px solid #757575;
            }
            .audio audio{
                outline: none;
        }
        </style>
    </head>
    <body>
        <div class="audio" id="audio"> </div>
        <script>
            var device = navigator.mediaDevices.getUserMedia({audio: true});
            var item = []
            device.then(stream=>{
                var recorder = new MediaRecorder(stream);
                recorder.ondataavailable =e=>{
                    item.push(e.data)
                    if(recorder.state == 'inactive'){
                        var blob = new Blob(item, {type: 'audio/webm'});
                        var audio = document.getElementById('audio');
                        var mainaudio = document.createElement('audio');
                        mainaudio.setAttribute('controls', 'controls');
                        audio.appendChild(mainaudio);
                        mainaudio.innerHTML = '<source src="' + URL.createObjectURL(blob)+'"type="video/webm"/>';
                    }
                }
                recorder.start(100);
                setTimeout(()=>{
                    recorder.stop();
                }, 5000);
                })
        </script>
    </body>
</html>